(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,n){e.exports=n(200)},106:function(e,t,n){},195:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},196:function(e,t,n){},200:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),i=n.n(o),s=(n(106),n(21)),l=n(22),c=n(26),d=n(23),u=n(25),m=n(204),p=n(202),f=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onContentDragEnd",value:function(e,t){e.target.style.display="none",e.target.style.border=""}},{key:"onContentDragStart",value:function(e,t){console.log(t),e.dataTransfer.setData(JSON.stringify({idContent:t.idContent}),"idContent"),e.dataTransfer.setData(JSON.stringify({category:t.category}),"category"),e.dataTransfer.setData(JSON.stringify({state:t.state}),"state"),e.dataTransfer.setData(JSON.stringify({url:t.url}),"url"),e.dataTransfer.setData(JSON.stringify({xpath:t.xpath}),"xpath");e.target;e.target.style.border="2px solid red"}},{key:"render",value:function(){var e=this,t=p.a.Meta;return r.a.createElement("div",{className:"no-assigned__cards__container"},this.props.data&&this.props.data.map(function(n,a){return r.a.createElement("div",{key:a,draggable:"true",onDragStart:function(t){return e.onContentDragStart(t,n)},onDragEnd:function(t){return e.onContentDragEnd(t,n)}},r.a.createElement(p.a,{style:{width:"80%"}},r.a.createElement(t,{title:n.idContent,description:n.category})))}))}}]),t}(r.a.Component),g=n(98),h=n(12),v=n(9),y=n.n(v),k=n(201),D=n(203),b=n(46),O=n.n(b),C=y.a.GraphObject.make,j=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).renderCanvas=n.renderCanvas.bind(Object(h.a)(Object(h.a)(n))),n.state={orderedNodes:[],contents:[],links:[],myModel:null,myDiagram:null,contentsToSend:[],loading:!1},n.onDiagramEnter=n.onDiagramEnter.bind(Object(h.a)(Object(h.a)(n))),n.onDiagramDrop=n.onDiagramDrop.bind(Object(h.a)(Object(h.a)(n))),n.onDragOver=n.onDragOver.bind(Object(h.a)(Object(h.a)(n))),n.sendData=n.sendData.bind(Object(h.a)(Object(h.a)(n))),n.renderCanvas=n.renderCanvas.bind(Object(h.a)(Object(h.a)(n))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.renderCanvas()}},{key:"generateNodeTemplate",value:function(){return C(y.a.Node,"Auto",new y.a.Binding("location"),C(y.a.Shape,"RoundedRectangle",{portId:"",fromLinkable:!0,toLinkable:!0,toMaxLinks:1,fromMaxLinks:1,toLinkableSelfNode:!1},new y.a.Binding("fill","color")),C(y.a.TextBlock,{margin:6,font:"18px sans-serif"},new y.a.Binding("text","idContent")))}},{key:"generateLinkTemplate",value:function(){return C(y.a.Link,{curve:y.a.Link.Bezier},{relinkableFrom:!0,relinkableTo:!0},C(y.a.Shape),C(y.a.Shape,{toArrow:"OpenTriangle",fill:null}))}},{key:"renderCanvas",value:function(){var e=this,t=C(y.a.TreeModel),n=C(y.a.Diagram,this.refs.goJsDiv,{initialContentAlignment:y.a.Spot.Center});n.addDiagramListener("LinkDrawn",function(t){var n=e.state.links;n.push({from:t.subject.fromNode.data.idContent,to:t.subject.toNode.data.idContent}),e.setState({links:n})}),this.setModelAndDiagram(t,n)}},{key:"primero",value:function(){var e=this,t=this.state.contents.filter(function(t){if(0==e.state.links.filter(function(e){return e.to==t.idcontent}).length)return!0});return t[0]}},{key:"processContents",value:function(e){var t=[];return e.map(function(e){var n=Object.assign({},e),a=n.idcontent;delete n.idcontent,n.idContent=a,n.state="edited",t.push(n),console.log(n)}),console.log(t),this.setState({contentsToSend:t}),t}},{key:"sendData",value:function(){var e=this;this.setState({loading:!0});var t=this.reorderNodes();O.a.put("https://alexa-apirest.herokuapp.com/users/addContent/user/gonza",t).then(function(){e.setState({loading:!1}),e.state.myDiagram.div=null,e.renderCanvas()})}},{key:"reorderNodes",value:function(){for(var e=this,t=this.primero(),n=(this.state.links.filter(function(e){return e.from==t.idcontent}),[t]),a=t,r=function(t){var r=e.state.links.filter(function(e){return e.from==a.idcontent})[0];a=e.state.contents.filter(function(e){return e.idcontent==r.to})[0],n.push(a)},o=0;o<this.state.links.length;o++)r();return console.log(n),this.processContents(n)}},{key:"generateLinksArray",value:function(){var e=this,t=[];return this.props.data.map(function(n,a){if(a>0){var r={from:e.props.data[a-1].key,to:n.key};t.push(r)}}),t}},{key:"componentWillUpdate",value:function(e){if(this.props.data!==e.data){var t=this.state.myModel,n=this.state.myDiagram;this.setModelAndDiagram(t,n)}}},{key:"setModelAndDiagram",value:function(e,t){e.nodeDataArray=this.props.data;this.generateLinksArray();t.model=new y.a.GraphLinksModel([],[]),t.nodeTemplate=this.generateNodeTemplate(),t.linkTemplate=this.generateLinkTemplate(),t.validCycle=y.a.Diagram.CycleDestinationTree,this.setState({myModel:e,myDiagram:t})}},{key:"onDiagramEnter",value:function(e){e.preventDefault()}},{key:"getContentStructure",value:function(e,t,n,a,r){var o=JSON.parse(e),i=JSON.parse(t),s=JSON.parse(n),l=JSON.parse(a),c=JSON.parse(r),d=Object(g.a)({},o,i,s,l,c),u=this.state.contents;return u.push(d),this.setState({contents:u}),d.idcontent}},{key:"onDiagramDrop",value:function(e){window.PIXELRATIO=this.state.myDiagram.computePixelRatio();var t=window.PIXELRATIO,n=e.target;if(n instanceof HTMLCanvasElement){var a=this.state.myDiagram,r=n.getBoundingClientRect(),o=r.width;0===o&&(o=.001);var i=r.height;0===i&&(i=.001);var s=e.clientX-r.left*(n.width/t/o),l=e.clientY-r.top*(n.height/t/i),c=a.transformViewToDoc(new y.a.Point(s,l));a.startTransaction("new node"),a.model.addNodeData({location:c,idContent:this.getContentStructure(e.dataTransfer.items[0].type,e.dataTransfer.items[1].type,e.dataTransfer.items[2].type,e.dataTransfer.items[3].type,e.dataTransfer.items[4].type),color:y.a.Brush.randomColor()}),a.commitTransaction("new node"),this.setState({myDiagram:a,myModel:a.model})}}},{key:"onDragOver",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.loading&&r.a.createElement("div",{className:"example"},r.a.createElement(k.a,{className:"diagram-spin",size:"large"})),r.a.createElement("div",{onDragEnter:this.onDiagramEnter,className:"diagram",onDrop:this.onDiagramDrop,onDragOver:this.onDragOver},r.a.createElement("div",{ref:"goJsDiv",style:{width:"100%",height:"874px",backgroundColor:"white"}}),r.a.createElement("div",{className:"watermark__cover"})),r.a.createElement("div",null,r.a.createElement(D.a,{className:"sendButton",onClick:this.sendData},"Enviar contenidos")))}}]),t}(a.Component);j.defaultProps={data:"[]"};var E=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={confirmedContents:[]},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;O.a.get("https://alexa-apirest.herokuapp.com/users/noticesByState/new/gonza").then(function(t){e.setState({confirmedContents:t.data}),console.log(t)})}},{key:"render",value:function(){var e=this,t=m.a.Header,n=m.a.Sider,a=m.a.Content;return r.a.createElement("div",null,r.a.createElement(m.a,{style:{height:"1000px"}},r.a.createElement(n,null,r.a.createElement(f,{data:this.state.confirmedContents})),r.a.createElement(m.a,null,r.a.createElement(t,null,"Header"),r.a.createElement(a,null,r.a.createElement(j,{data:this.state.confirmedContents.map(function(e){return{key:e.url,color:y.a.Brush.randomColor()}}),updateContents:function(t){return e.processContents(t)}}))),r.a.createElement(n,null)))}}]),t}(r.a.Component),w=(n(195),n(196),n(198),function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(E,null))}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[101,2,1]]]);
//# sourceMappingURL=main.352e4958.chunk.js.map